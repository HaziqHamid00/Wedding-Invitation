<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>Wedding Invitation</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body class="locked">

  <!-- ========= AUDIO ========= -->
  <audio id="bgMusic" loop preload="auto">
    <source src="music.mp3" type="audio/mpeg" />
  </audio>

  <button id="musicToggle" class="musicBtn" aria-label="Toggle music" title="Music">
    ğŸ”Š
  </button>

  <!-- ========= SPARKLES ========= -->
  <div id="sparkles" aria-hidden="true"></div>

  <!-- ========= HERO / ENVELOPE STAGE ========= -->
  <section class="heroSection" id="heroSection">
    <div class="stage">

      <!-- ENVELOPE LAYER -->
      <div class="envelopeWrap" id="envelopeWrap">
        <img src="envelope.png" id="envClosed" alt="Envelope (sealed)" />
        <img src="envelope_open.png" id="envOpen" alt="Envelope (opened)" />

        <!-- invisible click area on seal (hide OPEN text: we just click the seal area) -->
        <button id="sealBtn" aria-label="Open envelope"></button>
      </div>

      <!-- CARD LAYER (slides up to cover envelope) -->
      <div class="cardLayer" id="cardLayer" aria-hidden="true">
        <!-- Flip container (your suggested structure) -->
        <div class="flip-container" id="flipContainer">
          <div class="flipper" id="flipper">
            <div class="front">
              <img src="card1.png" alt="Card front (card1)" />
            </div>
            <div class="back">
              <img src="card2.png" alt="Card back (card2)" />
            </div>
          </div>
        </div>
        <p class="flipHint" id="flipHint">Tap card to flip</p>
      </div>

    </div>
  </section>

  <!-- ========= CONTENT (SCROLL ENABLED AFTER SEAL) ========= -->
  <main id="mainContent" class="content lockedContent">

    <!-- ========= DOA ========= -->
    <section class="doaSection">
      <div class="doaBlock">
        <img src="background_doa.png" class="doaBg" alt="Background doa" />

        <div class="doaText" id="doaText" aria-label="Doa text">
          <!-- 7 boxes, wrapped text, reveal on scroll -->
          <p class="line">ÙˆÙÙ…ÙÙ†Ù’ Ø¡ÙØ§ÙŠÙÙ€Ù°ØªÙÙ‡ÙÛ¦Ù“ Ø£ÙÙ†Ù’ Ø®ÙÙ„ÙÙ‚Ù Ù„ÙÙƒÙÙ… Ù…Ù‘ÙÙ†Ù’ Ø£ÙÙ†ÙÙØ³ÙÙƒÙÙ…Ù’ Ø£ÙØ²Ù’ÙˆÙÙ°Ø¬Ù‹Û­Ø§ Ù„Ù‘ÙØªÙØ³Ù’ÙƒÙÙ†ÙÙˆÙ“Ø§ÛŸ Ø¥ÙÙ„ÙÙŠÙ’Ù‡ÙØ§ ÙˆÙØ¬ÙØ¹ÙÙ„Ù Ø¨ÙÙŠÙ’Ù†ÙÙƒÙÙ… Ù…Ù‘ÙÙˆÙØ¯Ù‘ÙØ©Ù‹Û­ ÙˆÙØ±ÙØ­Ù’Ù…ÙØ©Ù‹ Ûš Ø¥ÙÙ†Ù‘Ù ÙÙÙ‰ Ø°ÙÙ°Ù„ÙÙƒÙ Ù„ÙÙ€Ù”ÙØ§ÙŠÙÙ€Ù°ØªÙÛ¢ Ù„Ù‘ÙÙ‚ÙÙˆÙ’Ù…ÙÛ¢ ÙŠÙØªÙÙÙÙƒÙ‘ÙØ±ÙÙˆÙ†Ù Ù¢Ù¡</p>
          <p class="line">And among His signs He created spouses for you from yourselves, that you may find tranquility in themâ€¦</p>
          <p class="line">â€¦and He placed between you affection and mercy. Truly in that are signs for those who reflect.</p>
          <p class="line">Û Ù‡ÙÙˆÙ Ù±Ù„Ù‘ÙØ°ÙÙ‰ Ø®ÙÙ„ÙÙ‚ÙÙƒÙÙ… Ù…Ù‘ÙÙ† Ù†Ù‘ÙÙÙ’Ø³ÙÛ¢ ÙˆÙÙ°Ø­ÙØ¯ÙØ©ÙÛ¢ ÙˆÙØ¬ÙØ¹ÙÙ„Ù Ù…ÙÙ†Ù’Ù‡ÙØ§ Ø²ÙÙˆÙ’Ø¬ÙÙ‡ÙØ§ Ù„ÙÙŠÙØ³Ù’ÙƒÙÙ†Ù Ø¥ÙÙ„ÙÙŠÙ’Ù‡ÙØ§ Û– ÙÙÙ„ÙÙ…Ù‘ÙØ§ ØªÙØºÙØ´Ù‘ÙÙ‰Ù°Ù‡ÙØ§ Ø­ÙÙ…ÙÙ„ÙØªÙ’ Ø­ÙÙ…Ù’Ù„Ù‹Ø§ Ø®ÙÙÙÙŠÙÙ‹Û­Ø§ ÙÙÙ…ÙØ±Ù‘ÙØªÙ’ Ø¨ÙÙ‡ÙÛ¦ Û– ÙÙÙ„ÙÙ…Ù‘ÙØ§Ù“ Ø£ÙØ«Ù’Ù‚ÙÙ„ÙØª Ø¯Ù‘ÙØ¹ÙÙˆÙØ§ Ù±Ù„Ù„Ù‘ÙÙ‡Ù Ø±ÙØ¨Ù‘ÙÙ‡ÙÙ…ÙØ§ Ù„ÙØ¦ÙÙ†Ù’ Ø¡ÙØ§ØªÙÙŠÙ’ØªÙÙ†ÙØ§ ØµÙÙ€Ù°Ù„ÙØ­Ù‹Û­Ø§ Ù„Ù‘ÙÙ†ÙÙƒÙÙˆÙ†ÙÙ†Ù‘Ù Ù…ÙÙ†Ù Ù±Ù„Ø´Ù‘ÙÙ€Ù°ÙƒÙØ±ÙÙŠÙ†Ù Ù¡Ù¨Ù©</p>
          <p class="line">It is He who created you from one soul and created from it its mate that he might dwell in security with her.</p>
          <p class="line">And when it becomes heavy, they both invoke Allah, their Lordâ€¦</p>
          <p class="line">â€œâ€¦If You should give us a good [child], we will surely be among the grateful.â€</p>
        </div>
      </div>
    </section>

    <!-- ========= COUNTDOWN + BUTTONS ========= -->
    <section class="countdownSection">
      <h2 class="sectionTitle">Wedding Countdown</h2>

      <div class="countdownBox" id="countdown" aria-label="Countdown timer">Loadingâ€¦</div>

      <div class="eventTime">
        <div>ğŸ“… <strong>2 May 2026</strong></div>
        <div>â° <strong>11:30 AM â€“ 3:30 PM</strong></div>
      </div>

      <div class="ctaRow">
        <a class="btn" href="https://maps.app.goo.gl/AhjAi5cvSQQTvU3F9" target="_blank" rel="noopener">
          ğŸ“ Google Map
        </a>

        <!-- RSVP BELOW GOOGLE MAP (as requested) -->
        <a class="btn btnSecondary" href="https://docs.google.com/forms/d/e/1FAIpQLSfBWe5IBelfTU7LKJhVfb5zdgDtQ7D1xK-jmd0pqqEJ1QBq4A/viewform" target="_blank" rel="noopener">
          ğŸ“ RSVP
        </a>
      </div>
    </section>

    <!-- ========= GALLERY (SWIPE SLIDER) ========= -->
    <section class="gallerySection" aria-label="Gallery">
      <h2 class="sectionTitle">Gallery</h2>

      <div class="galleryViewport" id="galleryViewport">
        <div class="galleryTrack" id="galleryTrack">
          <figure class="gallerySlide">
            <img src="gallery1.jpeg" alt="Gallery 1" />
          </figure>
          <figure class="gallerySlide">
            <img src="gallery2.jpeg" alt="Gallery 2" />
          </figure>
          <figure class="gallerySlide">
            <img src="gallery3.jpeg" alt="Gallery 3" />
          </figure>
          <figure class="gallerySlide">
            <img src="gallery4.jpeg" alt="Gallery 4" />
          </figure>
        </div>
      </div>

      <div class="galleryHint">Swipe left/right</div>
    </section>

  </main>

  <script>
    const body = document.body;

    const sealBtn = document.getElementById("sealBtn");
    const envClosed = document.getElementById("envClosed");
    const envOpen = document.getElementById("envOpen");

    const cardLayer = document.getElementById("cardLayer");
    const flipper = document.getElementById("flipper");

    const mainContent = document.getElementById("mainContent");

    const music = document.getElementById("bgMusic");
    const musicBtn = document.getElementById("musicToggle");

    const sparkles = document.getElementById("sparkles");
    let sparkInterval = null;

    /* ====== OPEN SEAL FLOW ====== */
    sealBtn.addEventListener("click", async () => {
      // show opened envelope
      envClosed.classList.add("hide");
      envOpen.classList.add("show");

      // enable card layer and animate it up covering the envelope
      cardLayer.classList.add("show");
      cardLayer.setAttribute("aria-hidden", "false");

      // enable scrolling
      body.classList.remove("locked");
      mainContent.classList.remove("lockedContent");

      // start sparkles
      startSparkles();

      // autoplay music (needs user gesture: this click qualifies)
      try {
        await music.play();
        musicBtn.textContent = "ğŸ”Š";
      } catch (e) {
        // if autoplay blocked, user can press the button
        musicBtn.textContent = "ğŸ”ˆ";
      }
    });

    /* ====== FLIP CARD (card1 <-> card2) ====== */
    const flipContainer = document.getElementById("flipContainer");
    flipContainer.addEventListener("click", () => {
      flipper.classList.toggle("flip");
    });

    /* ====== MUSIC TOGGLE ====== */
    musicBtn.addEventListener("click", async () => {
      if (music.paused) {
        try {
          await music.play();
          musicBtn.textContent = "ğŸ”Š";
        } catch (e) {
          musicBtn.textContent = "ğŸ”ˆ";
        }
      } else {
        music.pause();
        musicBtn.textContent = "ğŸ”ˆ";
      }
    });

    /* ====== COUNTDOWN ====== */
    const countdownEl = document.getElementById("countdown");
    const target = new Date("May 2, 2026 11:30:00").getTime();

    function tickCountdown() {
      const now = Date.now();
      const diff = target - now;

      if (diff <= 0) {
        countdownEl.textContent = "Itâ€™s time! ğŸ‰";
        return;
      }

      const days = Math.floor(diff / 86400000);
      const hrs = Math.floor(diff / 3600000) % 24;
      const min = Math.floor(diff / 60000) % 60;
      const sec = Math.floor(diff / 1000) % 60;

      countdownEl.textContent =
        `${days}d  ${String(hrs).padStart(2,"0")}h  ${String(min).padStart(2,"0")}m  ${String(sec).padStart(2,"0")}s`;
    }
    tickCountdown();
    setInterval(tickCountdown, 1000);

    /* ====== DOA TEXT REVEAL ON SCROLL (1-by-1) ====== */
    const lines = Array.from(document.querySelectorAll(".doaText .line"));

    const io = new IntersectionObserver((entries) => {
      entries.forEach((entry) => {
        if (!entry.isIntersecting) return;

        const idx = lines.indexOf(entry.target);
        // delay per line so they appear one-by-one as user scrolls into the section
        entry.target.style.transitionDelay = `${idx * 120}ms`;
        entry.target.classList.add("show");

        io.unobserve(entry.target);
      });
    }, { threshold: 0.55 });

    lines.forEach(line => io.observe(line));

    /* ====== SPARKLES ====== */
    function startSparkles() {
      if (sparkInterval) return;

      sparkInterval = setInterval(() => {
        const s = document.createElement("div");
        s.className = "spark";
        s.style.left = (Math.random() * 100) + "vw";
        s.style.top = (-10 - Math.random() * 10) + "vh";
        s.style.opacity = (0.6 + Math.random() * 0.4).toFixed(2);
        s.style.transform = `scale(${(0.6 + Math.random() * 1.2).toFixed(2)})`;
        s.style.animationDuration = (3.2 + Math.random() * 3.6).toFixed(2) + "s";
        sparkles.appendChild(s);

        setTimeout(() => s.remove(), 8000);
      }, 140);
    }

    /* ====== GALLERY (optional snap assist on swipe end) ====== */
    const galleryViewport = document.getElementById("galleryViewport");
    const galleryTrack = document.getElementById("galleryTrack");
    let startX = 0;
    let startScroll = 0;

    galleryViewport.addEventListener("touchstart", (e) => {
      startX = e.touches[0].clientX;
      startScroll = galleryViewport.scrollLeft;
    }, { passive: true });

    galleryViewport.addEventListener("touchmove", (e) => {
      const x = e.touches[0].clientX;
      const dx = startX - x;
      galleryViewport.scrollLeft = startScroll + dx;
    }, { passive: true });
  </script>

</body>
</html>
